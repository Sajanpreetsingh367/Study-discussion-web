<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>UPSC Study Club</title>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<style>
:root{--accent:#6c63ff;--accent2:#00c2a8;}
*{margin:0;padding:0;box-sizing:border-box;font-family:"Poppins",sans-serif;}
body{background:radial-gradient(circle at 50% 20%,#2a2a72 0%,#000 90%);color:#fff;text-align:center;overflow-x:hidden;}
.hidden{display:none;}
.grid{display:grid;grid-template-columns:repeat(2,1fr);gap:14px;margin-top:24px;}
.card{background:rgba(255,255,255,0.1);padding:18px;border-radius:14px;cursor:pointer;transition:.3s;}
.card:hover{background:rgba(255,255,255,0.25);}
.card img{width:70px;height:70px;margin-bottom:6px;}
.logoutBtn{margin-top:30px;background:linear-gradient(90deg,var(--accent),var(--accent2));border:none;padding:12px 22px;border-radius:10px;color:#fff;font-weight:700;cursor:pointer;}
.backBtn{position:absolute;left:10px;top:10px;border:none;background:rgba(255,255,255,0.1);padding:8px 14px;border-radius:10px;color:#fff;cursor:pointer;}
.sectionHeader{background:rgba(255,255,255,0.15);padding:14px 0;border-radius:12px;margin-bottom:16px;font-size:20px;font-weight:600;}
input{width:80%;padding:10px;margin:8px;border:none;border-radius:8px;font-size:15px;text-align:center;}
.option{background:rgba(255,255,255,0.1);margin:8px 0;padding:10px;border-radius:8px;cursor:pointer;}
.option:hover{background:rgba(255,255,255,0.2);}
.notice{background:rgba(255,255,255,0.08);padding:14px;border-radius:12px;margin-top:20px;font-size:13px;color:#ddd;text-align:left;}
.timerBox{background:rgba(255,255,255,0.1);display:inline-block;padding:6px 12px;border-radius:8px;margin-bottom:12px;font-weight:600;}
.popup{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.85);display:flex;align-items:center;justify-content:center;flex-direction:column;z-index:100;}
</style>
</head>

<body>
<!-- HOME -->
<div id="homeScreen">
  <h2>Your Course</h2>
  <p>Select a section</p>
  <div class="grid">
    <div class="card" onclick="openSection('current')"><img src="https://cdn-icons-png.flaticon.com/512/3135/3135715.png"><div>Current Affairs</div></div>
    <div class="card" onclick="openSection('practice')"><img src="https://cdn-icons-png.flaticon.com/512/201/201572.png"><div>Practice Questions</div></div>
    <div class="card" onclick="openSection('mindmap')"><img src="https://cdn-icons-png.flaticon.com/512/952/952717.png"><div>Mind Maps</div></div>
    <div class="card" onclick="openSection('interview')"><img src="https://cdn-icons-png.flaticon.com/512/3135/3135810.png"><div>Interview Q&A</div></div>
    <div class="card" onclick="openSection('books')"><img src="https://cdn-icons-png.flaticon.com/512/942/942748.png"><div>Book Summary</div></div>
    <div class="card" onclick="openSection('social')"><img src="https://cdn-icons-png.flaticon.com/512/1384/1384060.png"><div>Social Media</div></div>
    <div class="card" onclick="openSection('contest')"><img src="https://cdn-icons-png.flaticon.com/512/1828/1828884.png"><div>Contest</div></div>
  </div>
</div>

<!-- SECTION -->
<div id="sectionScreen" class="hidden">
  <button class="backBtn" onclick="goBack()">‚≠† Back</button>
  <div class="sectionHeader" id="secTitle"></div>
  <div id="imgList"></div>
</div>

<!-- CONTEST -->
<div id="contestScreen" class="hidden">
  <button class="backBtn" onclick="goBack()">‚≠† Back</button>
  <div class="sectionHeader">Contest</div>
  <p><b>Participants Joined:</b> <span id="joinedCount">0</span></p>
  <div id="participantList" style="margin-top:18px;text-align:left;max-height:200px;overflow:auto;"></div>
  <button id="payBtn" style="margin-top:25px;background:linear-gradient(90deg,#ff5858,#ff9e00);border:none;padding:12px 22px;border-radius:10px;font-size:16px;font-weight:700;color:white;" onclick="payEntry()">Pay Entry Fee ‚Çπ10</button>
  <button id="joinBtn" disabled style="margin-top:15px;background:#555;border:none;padding:12px 22px;border-radius:10px;font-size:16px;font-weight:700;color:white;cursor:not-allowed;" onclick="openContestQuiz()">Join Quiz</button>
  <div class="notice">
    üìù <b>Note:</b> Based on your quiz scores, top scorers (above 90%) will be shortlisted.<br>
    The final prize üèÜ depends on total participants.<br>
    2% platform fee will be deducted from the contest fund.
  </div>
</div>

<!-- REGISTRATION -->
<div id="contestQuizScreen" class="hidden">
  <button class="backBtn" onclick="goBack()">‚≠† Back</button>
  <div class="sectionHeader">Contest Quiz Registration</div>
  <input id="name" placeholder="Full Name" />
  <input id="father" placeholder="Father's Name" />
  <input id="mobile" placeholder="Mobile Number" />
  <button class="logoutBtn" onclick="submitDetails()">Submit Details</button>
  <p id="msg"></p>
  <div class="notice">
    ‚ö†Ô∏è <b>Notice:</b> Please enter correct details.<br>
    Winners will be contacted using this info.<br>
    You have <b>6 minutes</b> to complete the quiz.<br>
    When time ends, you‚Äôll be auto-redirected to the last question to submit.
  </div>
  <button style="margin-top:20px;background:linear-gradient(90deg,#00b09b,#96c93d);border:none;padding:12px 22px;border-radius:10px;font-size:16px;font-weight:700;color:white;" onclick="startQuiz()">Start Quiz</button>
</div>

<!-- QUIZ -->
<div id="quizScreen" class="hidden">
  <div class="sectionHeader">Contest Quiz</div>
  <div class="timerBox">‚è± <span id="timer">06:00</span></div>
  <div id="quizBox"></div>
</div>

<!-- RESULT -->
<div id="resultScreen" class="hidden">
  <div class="sectionHeader">Quiz Completed!</div>
  <h3 id="scoreText"></h3>
  <button onclick="goHome()" class="logoutBtn">Back to Home</button>
</div>

<!-- TIMEOUT POPUP -->
<div id="popup" class="popup hidden">
  <div>‚è∞ Time Out!</div>
  <button class="logoutBtn" onclick="closePopup()">Submit Quiz</button>
</div>

<script>
const links={
 current:"https://raw.githubusercontent.com/Sajanpreet35/Bighit/main/upsc_currentaffairs.json",
 practice:"https://raw.githubusercontent.com/avnoordeepsingh733-svg/Avnoor/main/upsc%20practise%20questions.json",
 mindmap:"https://raw.githubusercontent.com/avnoordeepsingh733-svg/Avnoor/main/mindmaps.json",
 interview:"https://raw.githubusercontent.com/avnoordeepsingh733-svg/Avnoor/main/upscinterviewpractisequestions.json",
 books:"https://raw.githubusercontent.com/Sajanpreet35/Bighit/main/upsc_books.json",
 social:"https://raw.githubusercontent.com/Sajanpreet35/Bighit/main/social_media_material.json",
 contest:"https://raw.githubusercontent.com/Sajanpreet35/Upsc-quiz-/main/upsc_quiz.json"
};
const supabase=window.supabase.createClient("https://zkqegvyxmtwyznizuhjt.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InprcWVndnl4bXR3eXpuaXp1aGp0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjA2MjkxMDYsImV4cCI6MjA3NjIwNTEwNn0.hC01DVzpgFg_cAVBs-Q6dalvUh1oU5OJ5NxkoEVY36o");

function hideAll(){
 document.querySelectorAll("div[id$='Screen']").forEach(el=>el.classList.add("hidden"));
 document.getElementById("quizBox").innerHTML=""; // clear quiz
}
async function openSection(sec){
 hideAll();
 if(sec==="contest"){openContest();return;}
 document.getElementById("sectionScreen").classList.remove("hidden");
 let data=await fetch(links[sec]).then(r=>r.json());
 document.getElementById("secTitle").innerText=data.title||sec;
 let list=document.getElementById("imgList");
 list.innerHTML="";
 (data.images||[]).forEach(src=>{
  let i=document.createElement("img");i.src=src;list.appendChild(i);
 });
}
async function openContest(){
 document.getElementById("contestScreen").classList.remove("hidden");
 const {data}=await supabase.from("aspirants").select("*");
 document.getElementById("joinedCount").innerText=data?.length||0;
 document.getElementById("participantList").innerHTML=data.map(p=>`üë§ ${p.name} (${p.mobile})`).join("<br>");
}
function payEntry(){
 alert("‚úÖ Payment Successful (Demo)");
 const b=document.getElementById("joinBtn");
 b.disabled=false;b.style.background="linear-gradient(90deg,#007bff,#00d4ff)";b.style.cursor="pointer";
}
function openContestQuiz(){hideAll();document.getElementById("contestQuizScreen").classList.remove("hidden");}
async function submitDetails(){
 const name=nameEl.value.trim(),father=fatherEl.value.trim(),mobile=mobileEl.value.trim();
 const msg=document.getElementById("msg");
 if(!name||!father||!mobile){msg.innerText="‚ö†Ô∏è Please fill all fields.";return;}
 const {error}=await supabase.from("aspirants").insert([{name,father_name:father,mobile}]);
 msg.innerText=error?"‚ùå "+error.message:"‚úÖ Saved!";
}
let quizData=[],current=0,score=0,userAnswers={},timerInt,seconds=360;
async function startQuiz(){
 hideAll();document.getElementById("quizScreen").classList.remove("hidden");
 const res=await fetch(links.contest);quizData=await res.json();
 current=0;score=0;seconds=360;userAnswers={};
 startTimer();showQuestion();
}
function startTimer(){updateTimer();timerInt=setInterval(()=>{seconds--;updateTimer();if(seconds<=0){clearInterval(timerInt);timeUp();}},1000);}
function updateTimer(){let m=Math.floor(seconds/60),s=seconds%60;document.getElementById("timer").innerText=`${String(m).padStart(2,"0")}:${String(s).padStart(2,"0")}`;}
function timeUp(){document.getElementById("popup").classList.remove("hidden");}
function closePopup(){document.getElementById("popup").classList.add("hidden");finishQuiz();}
function showQuestion(){
 const q=quizData[current];if(!q){finishQuiz();return;}
 const box=document.getElementById("quizBox");box.innerHTML=`<h3>Q${current+1}. ${q.question}</h3>`;
 for(const key in q.options){
  const div=document.createElement("div");div.className="option";div.innerText=`${key}. ${q.options[key]}`;
  div.onclick=()=>{userAnswers[current]=key;nextQuestion();};box.appendChild(div);
 }
 if(current===quizData.length-1){
  const btn=document.createElement("button");btn.className="logoutBtn";btn.innerText="Submit Quiz";btn.onclick=finishQuiz;box.appendChild(btn);
 }
}
function nextQuestion(){current++;showQuestion();}
async function finishQuiz(){
 clearInterval(timerInt);hideAll();
 document.getElementById("resultScreen").classList.remove("hidden");
 quizData.forEach((q,i)=>{if(userAnswers[i]===q.correct_answer)score++;});
 document.getElementById("scoreText").innerText=`You scored ${score}/${quizData.length}`;
 await supabase.from("contest_result").insert([{score}]);
}
function goBack(){hideAll();document.getElementById("homeScreen").classList.remove("hidden");}
function goHome(){goBack();}
</script>
</body>
</html>
