<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Study Discussion Club</title>
<style>
:root { --accent:#6C63FF; --accent2:#00C2A8;}
*{margin:0;padding:0;box-sizing:border-box;font-family:"Poppins",sans-serif;}
body{
  background:radial-gradient(circle at 50% 20%,#2a2a72 0%,#000 90%);
  color:white;text-align:center;padding:18px;
}
.hidden{display:none;}
.grid{margin-top:25px;display:grid;grid-template-columns:repeat(2,1fr);gap:16px;}
.card{
  background:rgba(255,255,255,0.08);padding:18px;border-radius:14px;
  cursor:pointer;transition:0.25s;
}
.card:hover{background:rgba(255,255,255,0.18);}
.card img{width:70px;height:70px;margin-bottom:6px;}
.logoutBtn{
  margin-top:35px;background:linear-gradient(90deg,var(--accent),var(--accent2));
  border:none;padding:12px 22px;border-radius:10px;color:white;font-weight:700;cursor:pointer;
}
.backBtn{
  position:absolute;left:12px;top:12px;border:none;background:rgba(255,255,255,0.13);
  padding:8px 14px;border-radius:10px;color:white;cursor:pointer;
}
#imgList img{
  width:100%;border-radius:14px;margin-bottom:20px;
  border:2px solid rgba(255,255,255,0.2);
}
input{
  width:90%;padding:10px;margin:8px auto;border:none;
  border-radius:10px;text-align:center;font-size:15px;
}
button{
  border:none;padding:12px 22px;border-radius:10px;
  color:white;font-weight:700;cursor:pointer;
}
</style>
</head>
<body>

<!-- âœ… HOME SCREEN -->
<div id="homeScreen">
  <h2 id="examName">Your Course</h2>
  <p>Select a learning section</p>
  <div class="grid">
    <div class="card" onclick="openSection('current')">
      <img src="https://cdn-icons-png.flaticon.com/512/3135/3135715.png">
      <div>Current Affairs</div>
    </div>
    <div class="card" onclick="openSection('practice')">
      <img src="https://cdn-icons-png.flaticon.com/512/201/201572.png">
      <div>Practice Questions</div>
    </div>
    <div class="card" onclick="openSection('mindmap')">
      <img src="https://cdn-icons-png.flaticon.com/512/952/952717.png">
      <div>Mind Maps</div>
    </div>
    <div class="card" onclick="openSection('interview')">
      <img src="https://cdn-icons-png.flaticon.com/512/3135/3135810.png">
      <div>Interview Q&A</div>
    </div>
    <div class="card" onclick="openSection('books')">
      <img src="https://cdn-icons-png.flaticon.com/512/942/942748.png">
      <div>UPSC Book Summary</div>
    </div>
    <div class="card" onclick="openSection('social')">
      <img src="https://cdn-icons-png.flaticon.com/512/1384/1384060.png">
      <div>Social Media Material</div>
    </div>
    <div class="card" onclick="openSection('contest')">
      <img src="https://cdn-icons-png.flaticon.com/512/1828/1828884.png">
      <div>Contest</div>
    </div>
  </div>
  <button class="logoutBtn" onclick="logoutUser()">Logout</button>
</div>

<!-- âœ… SECTION SCREEN -->
<div id="sectionScreen" class="hidden">
  <button class="backBtn" onclick="goBack()">â­  Back</button>
  <h2 id="secTitle">Loading...</h2>
  <div id="imgList"></div>
</div>

<!-- âœ… CONTEST SCREEN -->
<div id="contestScreen" class="hidden">
  <button class="backBtn" onclick="goBack()">â­  Back</button>
  <h2>ðŸ”¥ Contest</h2>
  <p>Fill your details to join</p>
  <input id="name" placeholder="Aspirant Name">
  <input id="father" placeholder="Father Name">
  <input id="mobile" placeholder="Mobile Number">
  <button style="background:linear-gradient(90deg,#ff5858,#ff9e00);" onclick="startQuiz()">Start Quiz</button>
</div>

<!-- âœ… QUIZ SCREEN -->
<div id="quizScreen" class="hidden">
  <button class="backBtn" onclick="goBack()">â­  Back</button>
  <h2>ðŸ§  Contest Quiz</h2>
  <div id="quizBox"></div>
  <button id="nextBtn" style="background:linear-gradient(90deg,#00c6ff,#0072ff);margin-top:15px;" onclick="nextQuestion()">Next</button>
</div>

<script>
const links = {
  current: "https://raw.githubusercontent.com/Sajanpreet35/Bighit/main/upsc_currentaffairs.json",
  practice: "https://raw.githubusercontent.com/avnoordeepsingh733-svg/Avnoor/main/upsc%20practise%20questions.json",
  mindmap: "https://raw.githubusercontent.com/avnoordeepsingh733-svg/Avnoor/main/mindmaps.json",
  interview: "https://raw.githubusercontent.com/avnoordeepsingh733-svg/Avnoor/main/upscinterviewpractisequestions.json",
  books: "https://raw.githubusercontent.com/Sajanpreet35/Bighit/main/upsc_books.json",
  social: "https://raw.githubusercontent.com/Sajanpreet35/Bighit/main/social_media_material.json",
  contest: "https://raw.githubusercontent.com/Sajanpreet35/Upsc-quiz-/main/upsc_quiz.json"
};

document.getElementById("examName").innerText =
(localStorage.getItem("selectedExam") || "UPSC") + " Course";

// âœ… Section open
async function openSection(sec){
  document.getElementById("homeScreen").classList.add("hidden");
  if(sec === "contest"){ openContest(); return; }

  document.getElementById("sectionScreen").classList.remove("hidden");
  let data = await fetch(links[sec]).then(r=>r.json());
  document.getElementById("secTitle").innerText = data.title;
  let list = document.getElementById("imgList");
  list.innerHTML = "";
  data.images.forEach(src=>{
    let i=document.createElement("img");
    i.src=src;
    list.appendChild(i);
  });
}

// âœ… Contest form open
function openContest(){
  document.getElementById("contestScreen").classList.remove("hidden");
}

// âœ… Quiz
let quizData = [];
let current = 0;
let score = 0;
let userAnswers = [];

async function startQuiz(){
  let n=document.getElementById("name").value.trim();
  let f=document.getElementById("father").value.trim();
  let m=document.getElementById("mobile").value.trim();
  if(!n || !f || !m){alert("Please fill all details");return;}
  document.getElementById("contestScreen").classList.add("hidden");
  document.getElementById("quizScreen").classList.remove("hidden");
  let res = await fetch(links.contest);
  quizData = await res.json();
  current=0; score=0; userAnswers=[];
  loadQuestion();
}

function loadQuestion(){
  const q = quizData[current];
  const box = document.getElementById("quizBox");
  box.innerHTML = `
    <div style='margin-top:15px;'>
      <img src="${q.question_image}" style="width:100%;border-radius:14px;margin-bottom:12px;">
      ${q.options.map((opt,i)=>`
        <div style='margin:8px 0;'>
          <input type='radio' name='opt' id='opt${i}' value='${opt}'>
          <label for='opt${i}'>${opt}</label>
        </div>`).join('')}
    </div>
  `;
  document.getElementById("nextBtn").innerText = current === quizData.length-1 ? "Submit Quiz" : "Next";
}

function nextQuestion(){
  let selected = document.querySelector('input[name="opt"]:checked');
  if(!selected){alert("Select an answer first!");return;}
  userAnswers.push(selected.value);
  if(selected.value === quizData[current].correct_answer) score++;
  current++;
  if(current < quizData.length){ loadQuestion(); }
  else{ endQuiz(); }
}

function endQuiz(){
  document.getElementById("quizBox").innerHTML = `
    <h3>Your Score: ${score} / ${quizData.length}</h3>
    <p>âœ… Your responses have been recorded!</p>`;
  document.getElementById("nextBtn").style.display="none";

  // ðŸ”¹ Example Supabase save placeholder
  /*
  const { data, error } = await supabase.from('responses').insert([
    { name:n, father_name:f, mobile:m, score:score }
  ]);
  */
}

// âœ… Back
function goBack(){
  document.querySelectorAll("div[id$='Screen']").forEach(e=>e.classList.add("hidden"));
  document.getElementById("homeScreen").classList.remove("hidden");
}

// âœ… Logout
function logoutUser(){
  localStorage.clear();
  window.location.href="index.html";
}
</script>

</body>
</html>
