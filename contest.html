<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Contest | Study Discussion Club</title>
<style>
:root { --accent:#6C63FF; --accent2:#00C2A8; }

body {
  background: radial-gradient(circle at 50% 20%, #1e1e3f 0%, #000 100%);
  color: white;
  font-family: "Poppins", sans-serif;
  margin: 0; padding: 0; text-align: center;
}
.hidden { display:none; }
h2 { margin-top: 15px; }

button {
  cursor:pointer; border:none; font-weight:600;
  border-radius:10px; padding:12px 22px; color:white;
}
.primary { background:linear-gradient(90deg,#ff5858,#ff9e00); }
.secondary { background:linear-gradient(90deg,#007bff,#00d4ff); }

.notice {
  background:rgba(255,255,255,0.09);
  padding:14px; border-radius:10px;
  margin:16px; font-size:13px; color:#e0e0e0;
  text-align:left;
}

.inputBox {
  width:80%; margin:10px auto; display:block;
  padding:12px; border-radius:10px;
  border:none; text-align:center;
}

.option {
  background:rgba(255,255,255,0.08);
  margin:8px 0; padding:10px;
  border-radius:8px; cursor:pointer; transition:0.2s;
}
.option:hover { background:rgba(255,255,255,0.18); }

.backBtn {
  position:absolute; left:12px; top:12px;
  border:none; background:rgba(255,255,255,0.13);
  padding:8px 14px; border-radius:10px; color:white; cursor:pointer;
}

.progress-container {
  width:90%; background:#333; height:12px;
  border-radius:8px; margin:15px auto;
}
.progress-bar { height:100%; background:limegreen; width:0%; border-radius:8px; }

.data-card {
  background:rgba(255,255,255,0.1);
  padding:16px; border-radius:10px;
  margin:10px; text-align:left;
}
.data-card img { width:100%; border-radius:10px; margin-top:8px; }
</style>
</head>
<body>

<!-- ‚úÖ CONTEST HOME -->
<div id="contestScreen">
  <button class="backBtn" onclick="goHome()">‚≠† Back</button>
  <h2>üèÜ Contest</h2>
  <p>Participants Joined: <span id="joinedCount">0</span></p>
  <div class="progress-container"><div class="progress-bar" id="progressBar"></div></div>
  <div class="notice">
    Dear aspirants, based on your scores, candidates scoring above 90 will be shortlisted.
    The shortlisted list and image will appear in the result section.
    The total contest prize depends on total participants‚Äô entry fees,
    after a 2% platform fee deduction.
  </div>
  <button class="primary" onclick="payEntry()">Pay Entry Fee ‚Çπ10</button>
  <button class="secondary" id="joinBtn" disabled onclick="openRegistration()">Join Quiz</button>
</div>

<!-- ‚úÖ REGISTRATION -->
<div id="registrationScreen" class="hidden">
  <button class="backBtn" onclick="backToContest()">‚≠† Back</button>
  <h2>üìù Quiz Registration</h2>
  <input id="fullName" class="inputBox" placeholder="Full Name">
  <input id="fatherName" class="inputBox" placeholder="Father's Name">
  <input id="mobileNumber" class="inputBox" placeholder="Mobile Number" type="tel">
  <div class="notice">
    Please fill correct details. Winners will be contacted via submitted info.<br>
    Quiz Duration: <b>6 minutes</b>. Timer will auto-submit on timeout.
  </div>
  <button class="secondary" onclick="saveDetails()">Submit Details</button>
  <button class="primary" onclick="startQuiz()">Start Quiz</button>
</div>

<!-- ‚úÖ QUIZ SCREEN -->
<div id="quizScreen" class="hidden">
  <button class="backBtn" onclick="exitQuiz()">‚≠† Exit</button>
  <h2 id="timer">‚è± 06:00</h2>
  <div id="quizBox"></div>
</div>

<!-- ‚úÖ RESULT SCREEN -->
<div id="resultScreen" class="hidden">
  <h2>üéâ Quiz Completed!</h2>
  <p id="scoreText"></p>
  <img id="shortlistImg" class="hidden" src="https://cdn-icons-png.flaticon.com/512/992/992703.png" width="100">
  <button class="primary" onclick="goHome()">Back to Home</button>
</div>

<script>
let joinedCount = 5290;
let max = 10000;
let quizData=[], current=0, score=0, timerInt, timeLeft=360;
let userData={};

function loadParticipants(){
  document.getElementById("joinedCount").innerText=joinedCount;
  document.getElementById("progressBar").style.width=(joinedCount/max*100)+"%";
}
loadParticipants();

function payEntry(){
  alert("‚úÖ Payment Successful (Demo)");
  document.getElementById("joinBtn").disabled=false;
  document.getElementById("joinBtn").style.opacity="1";
}
function openRegistration(){
  document.getElementById("contestScreen").classList.add("hidden");
  document.getElementById("registrationScreen").classList.remove("hidden");
}
function backToContest(){
  document.getElementById("registrationScreen").classList.add("hidden");
  document.getElementById("contestScreen").classList.remove("hidden");
}
function saveDetails(){
  const full=document.getElementById("fullName").value.trim();
  const father=document.getElementById("fatherName").value.trim();
  const mobile=document.getElementById("mobileNumber").value.trim();
  if(!full||!father||!mobile){alert("Please fill all details.");return;}
  userData={full,father,mobile};
  alert("‚úÖ Details saved successfully!");
}
async function startQuiz(){
  document.getElementById("registrationScreen").classList.add("hidden");
  document.getElementById("quizScreen").classList.remove("hidden");
  let res=await fetch("https://raw.githubusercontent.com/Sajanpreet35/Upsc-quiz-/main/upsc_quiz.json");
  quizData=await res.json();
  startTimer(); showQuestion();
}
function startTimer(){
  timerInt=setInterval(()=>{
    let min=Math.floor(timeLeft/60),sec=timeLeft%60;
    document.getElementById("timer").innerText=`‚è± ${String(min).padStart(2,'0')}:${String(sec).padStart(2,'0')}`;
    if(timeLeft<=0){clearInterval(timerInt);finishQuiz();}
    timeLeft--;
  },1000);
}
function showQuestion(){
  if(current>=quizData.length){finishQuiz();return;}
  let q=quizData[current];
  let box=document.getElementById("quizBox");
  box.innerHTML=`<h3>Q${current+1}. ${q.question}</h3>`;
  Object.entries(q.options).forEach(([key,val])=>{
    let div=document.createElement("div");
    div.className="option"; div.innerText=`${key}. ${val}`;
    div.onclick=()=>{if(key===q.correct_answer)score++;nextQuestion();};
    box.appendChild(div);
  });
  let next=document.createElement("button");
  next.className="primary"; next.innerText=current===quizData.length-1?"Finish Quiz":"Next";
  next.style.marginTop="20px"; next.onclick=()=>nextQuestion();
  box.appendChild(next);
}
function nextQuestion(){current++;showQuestion();}
function finishQuiz(){
  clearInterval(timerInt);
  document.getElementById("quizScreen").classList.add("hidden");
  document.getElementById("resultScreen").classList.remove("hidden");
  document.getElementById("scoreText").innerText=`You scored ${score}/${quizData.length}`;
  if(score>=90) document.getElementById("shortlistImg").classList.remove("hidden");
}
function exitQuiz(){ if(confirm("Exit quiz?"))goHome(); }
function goHome(){ window.location.href="index.html"; }
</script>
</body>
</html>
